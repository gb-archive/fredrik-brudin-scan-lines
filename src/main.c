#include <gb/gb.h>
#include "resources.h"

unsigned char effect[] =
{
   0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01,
   0x02, 0x02, 0x02, 0x02, 0x02, 0x02, 0x02, 0x02, 0x02, 0x02,
   0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03,
   0x04, 0x04, 0x04, 0x04, 0x04, 0x04, 0x04, 0x04, 0x04, 0x04,
   0x05, 0x05, 0x05, 0x05, 0x05, 0x06, 0x06, 0x06, 0x06, 0x06,
   0x07, 0x07, 0x07, 0x07, 0x07, 0x08, 0x08, 0x08, 0x08, 0x08,
   0x09, 0x09, 0x09, 0x09, 0x09, 0x08, 0x08, 0x08, 0x08, 0x08,
   0x07, 0x07, 0x07, 0x07, 0x07, 0x06, 0x06, 0x06, 0x06, 0x06,
   0x05, 0x05, 0x05, 0x04, 0x04, 0x04, 0x03, 0x03, 0x03, 0x03,
   0x02, 0x02, 0x02, 0x02, 0x02, 0x02, 0x02, 0x02, 0x02, 0x02,
   0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01
};

UBYTE counter;

void LCD_Interrupt(void)
{
	SCY_REG = effect[counter];
	counter++;
	if(counter >= 109)
  {
    counter = 0;
  }
}

void main(void)
{
  HIDE_SPRITES;
  HIDE_BKG;

  counter = 0;
  
  STAT_REG = 8;

  disable_interrupts();
  add_LCD(LCD_Interrupt);
  enable_interrupts();

  //Set background
  set_bkg_data(0, 101, tiles);
  set_bkg_tiles(0, 0, 20, 22, map);

  set_interrupts(LCD_IFLAG);

  SHOW_BKG;
  SHOW_SPRITES;

	while(1)
	{
		wait_vbl_done();
	}
}